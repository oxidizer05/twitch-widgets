{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/frontend/js/request.js","src/frontend/js/vote.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","url","callback","httpRequest","window","XMLHttpRequest","overrideMimeType","ActiveXObject","onreadystatechange","open","send","console","log","request","voteCallback","readyState","status","data","JSON","parse","responseText","condidateA","condidateB","total","votes","calcPercent","voices","Math","round","getWidth","percent","percentA","percentB","getText","document","querySelector","style","width","innerHTML","command","setInterval"],"mappings":"CAAA,SAAAA,EAAAC,EAAAC,EAAAC,GAAA,SAAAC,EAAAC,EAAAC,GAAA,IAAAJ,EAAAG,GAAA,CAAA,IAAAJ,EAAAI,GAAA,CAAA,IAAAE,EAAA,mBAAAC,SAAAA,QAAA,IAAAF,GAAAC,EAAA,OAAAA,EAAAF,GAAA,GAAA,GAAAI,EAAA,OAAAA,EAAAJ,GAAA,GAAA,IAAAK,EAAA,IAAAC,MAAA,uBAAAN,EAAA,KAAA,MAAAK,EAAAE,KAAA,mBAAAF,EAAA,IAAAG,EAAAX,EAAAG,GAAA,CAAAS,QAAA,IAAAb,EAAAI,GAAA,GAAAU,KAAAF,EAAAC,SAAA,SAAAd,GAAA,OAAAI,EAAAH,EAAAI,GAAA,GAAAL,IAAAA,KAAAa,EAAAA,EAAAC,QAAAd,EAAAC,EAAAC,EAAAC,GAAA,OAAAD,EAAAG,GAAAS,QAAA,IAAA,IAAAL,EAAA,mBAAAD,SAAAA,QAAAH,EAAA,EAAAA,EAAAF,EAAAa,OAAAX,IAAAD,EAAAD,EAAAE,IAAA,OAAAD,EAAA,CAAA,CAAAa,EAAA,CAAA,SAAAT,EAAAU,EAAAJ,GCAAI,EAAAJ,QAAA,CAAAK,EAAAC,KACA,IAAAC,EAEA,GAAAC,OAAAC,eACAF,EAAA,IAAAE,eACAF,EAAAG,kBACAH,EAAAG,iBAAA,yBAGA,GAAAF,OAAAG,cACA,IACAJ,EAAA,IAAAI,cAAA,kBACA,MACA,IACAJ,EAAA,IAAAI,cAAA,qBACA,QAIAJ,GAKAA,EAAAK,mBAAA,IAAAN,EAAAC,GACAA,EAAAM,KAAA,MAAAR,GAAA,GACAE,EAAAO,KAAA,OANAC,QAAAC,IAAA,qFCpBA,MAAAC,EAAAvB,EAAA,aAMA,SAAAwB,EAAAX,GACA,GAAA,GAAAA,EAAAY,WACA,GAAA,KAAAZ,EAAAa,OAAA,CACA,MAAAC,EAAAC,KAAAC,MAAAhB,EAAAiB,cAGA,GAFAT,QAAAC,IAAAK,IAEAA,EACA,OAEA,MAAAI,WAAAA,EAAAC,WAAAA,GAAAL,EACAM,EAAAF,EAAAG,MAAAF,EAAAE,MAEAC,EAAAC,GAAAH,GAAA,EAAA,EAAAI,KAAAC,MAAAF,EAAAH,EAAA,KACAM,EAAAC,IAAAC,GAAA,GAAAC,GAAA,EAAA,GAAAF,GAAA,IACAG,EAAAH,GAAAA,EAAA,IAEAC,EAAAN,EAAAJ,EAAAG,OACAQ,EAAAP,EAAAH,EAAAE,OAEAU,SAAAC,cAAA,eAAAC,MAAAC,MAAAR,EAAAE,GACAG,SAAAC,cAAA,eAAAC,MAAAC,MAAAR,EAAAG,GACAE,SAAAC,cAAA,gBAAAG,UAAAL,EAAAF,GACAG,SAAAC,cAAA,gBAAAG,UAAAL,EAAAD,GACAE,SAAAC,cAAA,mBAAAG,UAAAjB,EAAAkB,QACAL,SAAAC,cAAA,mBAAAG,UAAAhB,EAAAiB,aAGA5B,QAAAC,IAAA,yCAAAT,EAAAa,QA/BAwB,YAAA,KACA3B,EAAA,4BAAAC,IACA","file":"vote.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","module.exports = (url, callback) => {\r\n    let httpRequest;\r\n\r\n    if (window.XMLHttpRequest) { // Mozilla, Safari, ...\r\n        httpRequest = new XMLHttpRequest();\r\n        if (httpRequest.overrideMimeType) {\r\n            httpRequest.overrideMimeType(\"application/json\");\r\n        }\r\n    }\r\n    else if (window.ActiveXObject) { // IE\r\n        try {\r\n            httpRequest = new ActiveXObject(\"Msxml2.XMLHTTP\");\r\n        } catch {\r\n            try {\r\n                httpRequest = new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n            } catch { }\r\n        }\r\n    }\r\n\r\n    if (!httpRequest) {\r\n        console.log(\"Не вышло :( Невозможно создать экземпляр класса XMLHTTP \");\r\n        return;\r\n    }\r\n\r\n    httpRequest.onreadystatechange = () => callback(httpRequest);\r\n    httpRequest.open(\"GET\", url, true);\r\n    httpRequest.send(null);\r\n};","const request = require(\"./request\");\r\n\r\nsetInterval(() => {\r\n    request(\"http://localhost/api/vote\", voteCallback);\r\n}, 3000);\r\n\r\nfunction voteCallback(httpRequest) {\r\n    if (httpRequest.readyState == 4) {\r\n        if (httpRequest.status == 200) {\r\n            const data = JSON.parse(httpRequest.responseText);\r\n            console.log(data);\r\n\r\n            if (!data)\r\n                return;\r\n\r\n            const { condidateA, condidateB } = data;\r\n            const total = condidateA.votes + condidateB.votes;\r\n\r\n            const calcPercent = (voices) => total <= 0 ? 0 : Math.round(voices / total * 100);\r\n            const getWidth = (percent) => (percentA <= 0 && percentB <= 0 ? 50 : percent) + \"%\";\r\n            const getText = (percent) => percent + \"%\";\r\n\r\n            const percentA = calcPercent(condidateA.votes);\r\n            const percentB = calcPercent(condidateB.votes);\r\n\r\n            document.querySelector(\".bar-user-a\").style.width = getWidth(percentA);\r\n            document.querySelector(\".bar-user-b\").style.width = getWidth(percentB);\r\n            document.querySelector(\".text-user-a\").innerHTML = getText(percentA);\r\n            document.querySelector(\".text-user-b\").innerHTML = getText(percentB);\r\n            document.querySelector(\".command-user-a\").innerHTML = condidateA.command;\r\n            document.querySelector(\".command-user-b\").innerHTML = condidateB.command;\r\n        }\r\n        else {\r\n            console.log(\"С запросом возникла проблема. status: \" + httpRequest.status);\r\n        }\r\n    }\r\n}\r\n"]}