!function e(t,n,r){function o(i,a){if(!n[i]){if(!t[i]){var u="function"==typeof require&&require;if(!a&&u)return u(i,!0);if(c)return c(i,!0);var s=new Error("Cannot find module '"+i+"'");throw s.code="MODULE_NOT_FOUND",s}var l=n[i]={exports:{}};t[i][0].call(l.exports,(function(e){return o(t[i][1][e]||e)}),l,l.exports,e,t,n,r)}return n[i].exports}for(var c="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.f_precentWhatLeft=n.f_moduleName=n.bitRotate=n.deepCopy=n.shallowCopy=n.bin2dec=n.dec2bin=n.escapeJSON=n.time=n.factorial=n.getKey=n.renameKey=n.sleep=n.precentWhat=n.precentWhatLeft=n.mod=n.timestamp=n.caclms=n.isPrimitive=n.moduleNameEx=n.moduleName=n.firstMatch=n.commandArgs=n.REGEX_BASE64=n.REGEX_QUOTES=n.REGEX_COMMAND_LINE=n.REGEX_FILENAME=void 0,n.REGEX_FILENAME=/[^/\\]+\.(.+)$/,n.REGEX_COMMAND_LINE=/".+"|'.+'|\S+/g,n.REGEX_QUOTES=/^"|"$|^'|'$/g,n.REGEX_BASE64=/^data:([+/A-Za-z-]+);base64,(.+)$/,n.commandArgs=function(e){var t=e.match(n.REGEX_COMMAND_LINE);if(t)return t.map((function(e){return e.replace(n.REGEX_QUOTES,"")}))},n.firstMatch=function(e,t){var n=e.match(t);return n?n[0]:void 0},n.moduleName=function(e){return n.firstMatch(e.filename,n.REGEX_FILENAME)||"NULL!"},n.moduleNameEx=function(){return t.parent&&n.firstMatch(t.parent.filename,n.REGEX_FILENAME)||"NULL!"},n.isPrimitive=function(e){return null===e||"object"!=typeof e&&"function"!=typeof e},n.caclms=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),1e3*(3600*e+60*t+n)},n.timestamp=function(){return Math.floor(Date.now()/1e3)},n.mod=function(e,t){return(e%t+t)%t},n.precentWhatLeft=function(e,t){return Math.floor((t-e)/t*100)},n.precentWhat=function(e,t){return Math.floor(100*e/t)},n.sleep=function(e){return new Promise((function(t){setTimeout(t,e)}))},n.renameKey=function(e,t,n){var r;delete Object.assign(e,(r={},r[n]=e[t],r))[t]},n.getKey=function(e,t){return Object.keys(e).find((function(n){return e[n]===t}))},n.factorial=function(e){return e<=1?1:e*n.factorial(e-1)},n.time=function(){var e=new Date;return e.getMinutes()+":"+e.getSeconds()+":"+e.getMilliseconds()},n.escapeJSON=function(e){return e.replace(/\\n/g,"\\n").replace(/\\'/g,"\\'").replace(/\\"/g,'\\"').replace(/\\&/g,"\\&").replace(/\\r/g,"\\r").replace(/\\t/g,"\\t").replace(/\\b/g,"\\b").replace(/\\f/g,"\\f")},n.dec2bin=function(e){return(e>>>0).toString(2)},n.bin2dec=function(e){return Number.parseInt(e,2)>>0},n.shallowCopy=function(e){return Object.assign({},e)},n.deepCopy=function(e){return JSON.parse(JSON.stringify(e))},n.bitRotate=function(e,t,r){var o=n.dec2bin(e);return t%=o.length,n.bin2dec(r?o.slice(-t)+o.slice(0,-t):o.slice(t)+o.slice(0,t))},n.f_moduleName=function(e){return"["+n.moduleName(e)+"]"},n.f_precentWhatLeft=function(e,t){return n.precentWhatLeft(e,t)+"%"}},{}],2:[function(e,t,n){const r=e("./request"),{timestamp:o}=e("ts-raz-util");let c,i;const a=setInterval(()=>{r("http://localhost/api/draw",u)},1e3);function u(e){if(4==e.readyState)if(200==e.status){const t=JSON.parse(e.responseText);if(console.log(t),!t)return;if(document.querySelector(".draw-voted").innerHTML=t.userCount,document.querySelector(".draw-command").innerHTML=t.command,document.querySelector(".draw-text").innerHTML=t.text,t.endTimestamp){if(!c&&!i){let e=t.endTimestamp-o();if(e<1)return t.lastWinner?d(t.lastWinner):f(),void l(0);c=setInterval(()=>{l(e),e<1?(clearInterval(c),f()):e--},1e3)}}else l(t.countdownSeconds)}else console.log("С запросом возникла проблема. status: "+e.status),c&&clearInterval(c),c=void 0}const s=e=>e>9?e:"0"+e;function l(e){const t=Math.floor(e/60),n=Math.floor(e%60);document.querySelector(".draw-countdown").innerHTML=s(t)+":"+s(n)}function f(){console.log("sendWinnerRequset"),i=!0,r("http://localhost/api/draw/winner",e=>{4==e.readyState&&(200==e.status?d(e.responseText):(i=!1,console.log("С запросом возникла проблема. status: "+e.status)))})}function d(e){console.log("completeDrawing > Winner: "+e),clearInterval(a),document.querySelector(".draw").classList.add("opacity-none"),document.querySelector(".winner-name").innerHTML=e,setTimeout(()=>{document.querySelector(".draw").classList.add("hidden"),document.querySelector(".winner").classList.remove("opacity-none")},1500)}},{"./request":3,"ts-raz-util":1}],3:[function(e,t,n){t.exports=(e,t)=>{let n;if(window.XMLHttpRequest)n=new XMLHttpRequest,n.overrideMimeType&&n.overrideMimeType("application/json");else if(window.ActiveXObject)try{n=new ActiveXObject("Msxml2.XMLHTTP")}catch{try{n=new ActiveXObject("Microsoft.XMLHTTP")}catch{}}n?(n.onreadystatechange=()=>t(n),n.open("GET",e,!0),n.send(null)):console.log("Не вышло :( Невозможно создать экземпляр класса XMLHTTP ")}},{}]},{},[2]);
//# sourceMappingURL=draw.min.js.map
